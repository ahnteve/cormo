// Generated by CoffeeScript 1.8.0
(function() {
  var Promise;

  Promise = require('bluebird');

  exports.getLeafOfPath = function(obj, path, create_object) {
    var last, part, parts, _i, _j, _len, _len1;
    parts = Array.isArray(path) ? path.slice(0) : path.split('.');
    last = parts.pop();
    if (parts.length > 0) {
      if (create_object !== false) {
        for (_i = 0, _len = parts.length; _i < _len; _i++) {
          part = parts[_i];
          obj = obj[part] || (obj[part] = {});
        }
      } else {
        for (_j = 0, _len1 = parts.length; _j < _len1; _j++) {
          part = parts[_j];
          obj = obj[part];
          if (!obj) {
            return [];
          }
        }
      }
    }
    return [obj, last];
  };

  exports.getPropertyOfPath = function(obj, path) {
    var last, _ref;
    _ref = exports.getLeafOfPath(obj, path, false), obj = _ref[0], last = _ref[1];
    return obj != null ? obj[last] : void 0;
  };

  exports.setPropertyOfPath = function(obj, path, value) {
    var last, _ref;
    _ref = exports.getLeafOfPath(obj, path), obj = _ref[0], last = _ref[1];
    obj[last] = value;
  };

  exports.bindDomain = function(fn) {
    var d;
    if (fn && (d = process.domain)) {
      return d.bind(fn);
    } else {
      return fn;
    }
  };

}).call(this);
